# ì„¹ì…˜ 12. TanStack Query (React Query) ì„¤ì •

- **[TanStack Query (React Query)]**
    - ì„œë²„ ë°ì´í„°ì˜ ìºì‹± ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ **ë¶ˆí•„ìš”í•œ ì„œë²„ í˜¸ì¶œì„ ì¤„ìž„**
    - **ê°„ê²°í•œ ì½”ë“œ**ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬ êµ¬í˜„ ê°€ëŠ¥
    - ë°ì´í„° ë™ê¸°í™”, ë¡œë”© ìƒíƒœ, ì—ëŸ¬ í•¸ë“¤ë§ ë“±ì„ **ìžë™ìœ¼ë¡œ ê´€ë¦¬**

- **[Zustand]**
    - ê¸°ì¡´ Reduxì˜ ë³µìž¡í•¨ì„ í•´ì†Œí•œ **ê°„íŽ¸í•œ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬**
    - ë¦¬ë•ìŠ¤ íˆ´í‚· ì´ì „ì˜ **ë¶ˆíŽ¸í•¨ ì—†ì´ ê°€ë²¼ìš´ ì „ì—­ ìƒíƒœ ê´€ë¦¬** ê°€ëŠ¥
    - ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ ìµœì†Œí™”

---

### ðŸŽ¯ ê°œë°œ ëª©í‘œ

1. **TanStack Query(React Query)ì˜ ì„¤ì • ë° ìƒí’ˆ ê´€ë¦¬ ê¸°ëŠ¥ ì ìš©**
    - ìƒí’ˆ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
    - ì„œë²„ ë°ì´í„° ìºì‹±
    - ë¡œë”©/ì—ëŸ¬ ì²˜ë¦¬ UI ì—°ë™

2. **Zustand ì„¤ì • ë° ë¡œê·¸ì¸ ìƒíƒœ ì²˜ë¦¬ ì ìš©**
    - ë¡œê·¸ì¸ ìƒíƒœ ì „ì—­ ê´€ë¦¬
    - ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
    - ì‚¬ìš©ìž ì¸ì¦ ìƒíƒœì— ë”°ë¥¸ UI ë¶„ê¸° ì²˜ë¦¬

## TanStack

### TanStack Query ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
```
npm i @tanstack/react-query
```
```
npm i @tanstack/react-query-devtools 
```

### TanStack Queryì˜ ì„¤ì •
QueryClientë¥¼ ì§€ì • : main.tsx
- ë‚˜ì¤‘ì— ìŠ¤í† ì–´ ëºŒ -> Zustand ë³€ê²½
```

```

## TanStack Query í•µì‹¬ ê°œë… ì •ë¦¬

### í•µì‹¬ ê°œë…
TanStack QueryëŠ” ë°ì´í„°ë¥¼ ë³´ê´€í•˜ë©°, ìƒíƒœì— ë”°ë¼ ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ìºì‹œëœ ë°ì´í„°ë¥¼ í™œìš©í•œë‹¤.

### ë°ì´í„° ìƒíƒœ ë³€í™”
ê°œë°œìž ë„êµ¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìžˆëŠ” ëŒ€í‘œì ì¸ ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
- fetching: ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘
- fresh: ë°ì´í„°ê°€ ìµœì‹  ìƒíƒœë¡œ ì²˜ë¦¬ ì™„ë£Œë¨

### staleTimeì˜ í™œìš©
staleTimeì€ ë°ì´í„°ì˜ ì‹ ì„ ë„ë¥¼ íŒë‹¨í•˜ëŠ” ê¸°ì¤€ ì‹œê°„ì´ë‹¤. ì´ ì‹œê°„ì´ ì§€ë‚˜ë©´ í•´ë‹¹ ë°ì´í„°ëŠ” stale ìƒíƒœê°€ ë˜ì–´ ë‹¤ì‹œ ì„œë²„ë¡œë¶€í„° ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê²Œ ëœë‹¤.

### ìƒíƒœ ë³€í™” ì˜ˆì‹œ
ê°œë°œìž ë„êµ¬ë¥¼ í†µí•´ ë‹¤ìŒê³¼ ê°™ì€ ìƒíƒœ íë¦„ì„ í™•ì¸í•  ìˆ˜ ìžˆë‹¤:
fetching â†’ fresh â†’ (10ì´ˆ í›„) stale

### ì„œë²„ í˜¸ì¶œ íƒ€ì´ë°
í˜„ìž¬ í™”ë©´ì´ í™œì„±í™”ë  ë•Œ TanStack QueryëŠ” í•„ìš”í•œ ê²½ìš° ì„œë²„ì— ë‹¤ì‹œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤. ì‚¬ìš©ìžê°€ ë‹¤ë¥¸ í”„ë¡œê·¸ëž¨ì„ ì„ íƒí–ˆë‹¤ê°€ ëŒì•„ì˜¤ëŠ” ê²½ìš° ì¼ì • ì‹œê°„ ë™ì•ˆì€ ì„œë²„ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³  ìºì‹œëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤.

## useQueryì˜ ìžë™ ì„œë²„ í˜¸ì¶œ ë™ìž‘

### ê¸°ë³¸ ë™ìž‘
'useQuery'ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë¸Œë¼ìš°ì €ê°€ ë‹¤ì‹œ í™œì„±í™”ë  ë•Œ ì„œë²„ë¥¼ ìžë™ìœ¼ë¡œ ë‹¤ì‹œ í˜¸ì¶œí•˜ëŠ” ë™ìž‘ì„ ê°€ì§„ë‹¤.  
ì´ëŠ” ìºì‹œëœ ë°ì´í„°ê°€ 'stale' ìƒíƒœì¼ ê²½ìš° ì ìš©ëœë‹¤.

### stale ìƒíƒœì— ë”°ë¥¸ ì„œë²„ í˜¸ì¶œ
- stale ìƒíƒœì˜ ë°ì´í„°ëŠ” ì˜¤ëž˜ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ì–´ ì„œë²„ì— ìž¬ìš”ì²­ì„ ë³´ë‚¸ë‹¤.

### staleTime ì„¤ì •ì— ë”°ë¥¸ ë™ìž‘ ë³€í™”
- staleTimeì´ ì§§ì„ìˆ˜ë¡ ë°ì´í„°ê°€ ë¹ ë¥´ê²Œ stale ìƒíƒœë¡œ ì „í™˜ë˜ì–´ ì„œë²„ë¥¼ ìžì£¼ í˜¸ì¶œí•˜ê²Œ ëœë‹¤.
- staleTimeì´ ê¸¸ë©´ ë°ì´í„°ê°€ ì˜¤ëžœ ì‹œê°„ fresh ìƒíƒœë¥¼ ìœ ì§€í•˜ë¯€ë¡œ ì„œë²„ í˜¸ì¶œì´ ì¤„ì–´ë“ ë‹¤.

### ì°¸ê³  ë§í¬
ìžì„¸í•œ ì˜µì…˜ì€ ê³µì‹ ë¬¸ì„œì—ì„œ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤:  
https://tanstack.com/query/latest/docs/framework/react/overview

## Zustand ë¼ì´ë¸ŒëŸ¬ë¦¬

- Contextë‚˜ Reduxì— ë¹„í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
- ZustandëŠ” ë…ì¼ì–´ë¡œ ìƒíƒœ(state)ë¥¼ ì˜ë¯¸
- https://zustand-demo.pmnd.rs/ 
```
import { create } from 'zustand';

type Store = {
  count: number;
  inc: () => void;
};

const useStore = create<Store>()((set) => ({
  count: 1,
  inc: () => set((state) => ({ count: state.count + 1 })),
}));

function Counter() {
  const { count, inc } = useStore();

  return (
    <div>
      <span>{count}</span>
      <button onClick={inc}>one up</button>
    </div>
  );
}
```

### ì„¤ì¹˜
```
npm install zustand
```

### Zustandì˜ ìŠ¤í† ì–´ ìž‘ì„± ìˆœì„œ
- ì „ì—­ìœ¼ë¡œ ìœ ì§€í•˜ê³  ì‹¶ì€ ìƒíƒœì™€ ì´ì— ëŒ€í•œ ë³€ê²½ì´ ê°€ëŠ¥í•œ í•¨ìˆ˜ë¥¼ íƒ€ìž…ìœ¼ë¡œ ì„ ì–¸ â€“xxxStore
- createì‹œì— ì£¼ì–´ì§€ëŠ” íŒŒë¼ë¯¸í„°ëŠ” set, get
- ìž‘ì„±í•˜ëŠ” í•¨ìˆ˜ì˜ ë‚´ë¶€ì—ì„œ  set( )ì„ ì´ìš©í•´ì„œ í•„ìš”í•œ ë°ì´í„°ë§Œ ìˆ˜ì • 
```
import { create } from 'zustand';

type Store = {
  count: number;
  inc: () => void;
};

const useStore = create<Store>()((set) => ({
  count: 1,
  inc: () => set((state) => ({ count: state.count + 1 })),
}));
```

