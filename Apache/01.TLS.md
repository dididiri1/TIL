# 🔐 Apache에서 TLS 1.0 / TLS 1.1 차단하기

보안 취약점을 줄이기 위해서는 **낮은 버전의 TLS 프로토콜(TLS 1.0, TLS 1.1)** 을 차단하고   
TLS 1.2 이상만 허용하는 것이 권장된다.

### ✅ 1. 현재 TLS 설정 확인
- /etc/httpd/conf/httpd-ssl.conf
- 또는 VirtualHost 설정 파일 (<VirtualHost *:443> ... </VirtualHost>)
```
vi /httpd-ssl.conf
```

### ✅ 2. TLS 1.0 / 1.1 비활성화 설정
- VirtualHost 443 블록 안에 추가
```
<VirtualHost *:443>
    SSLEngine on

    # ✅ TLS 1.2 이상만 허용(추가)
    SSLProtocol -all +TLSv1.2 +TLSv1.3

    SSLCipherSuite HIGH:!aNULL:!MD5:!3DES:!RC4
    SSLHonorCipherOrder on

    SSLCertificateFile /경로/cert.pem
    SSLCertificateKeyFile /경로/key.pem
    SSLCertificateChainFile /경로/chain.pem
    
</VirtualHost>
```
- 🔹 SSLProtocol -all +TLSv1.2 +TLSv1.3 → TLS 1.0 / 1.1 / SSLv3 모두 차단하고 TLS 1.2+만 허용
- 🔹 SSLHonorCipherOrder on → 서버 우선 암호화 스위트 적용

### ✅ 3. Apache 재시작
```
apachectl restart          # Apache 재시작

systemctl apache restart   # Apache 재시작
```

### ✅ 4. TLS 차단 여부 테스트
- OpenSSL로 직접 TLS 1.0, 1.1 연결 테스트
```
# TLS 1.0 테스트
openssl s_client -connect www.example.com:443 -tls1

# TLS 1.1 테스트
openssl s_client -connect www.example.com:443 -tls1_1
```

#### 정상 차단 시 결과 예시
```
1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version
no peer certificate available

```

> 📌 정리
> Apache에서 SSLProtocol로 TLS 버전 제어 가능
> -all +TLSv1.2 +TLSv1.3 → TLS 1.0/1.1 완전 차단
> 적용 후 OpenSSL로 직접 테스트하여 확인