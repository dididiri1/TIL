
# 섹션 12.보너스) 리엑트와 타입스크립트

## 타입스크립트 리엑트 시작하기
### React + TypeScript 프로젝트 설정

#### 1. 프로젝트 생성
현재 디렉토리에 React 프로젝트를 생성한다.
```
npx create-react-app .
```

#### 2. TypeScript 관련 패키지 설치
TypeScript가 Node.js, React, React-DOM, Jest를 제대로 인식하도록 타입 정의 패키지를 설치한다.
```
npm i @types/node @types/react @types/react-dom @types/jest
```

#### 3. tsconfig.json 설정
TypeScript 컴파일러 설정을 정의하는 파일이다.
```
{
  "compilerOptions": {
    "target": "ES5",
    "module": "CommonJS",
    "strict": true,
    "allowJs": true,
    "esModuleInterop": true,
    "jsx": "react-jsx"
  },
  "include": ["src"]
}
```
- 타겟 ES5: 더 넓은 호환성 제공
- CommonJS 모듈: Node.js 환경과 호환
- 엄격한 타입 체크: 코드 안정성 향상
- JS 파일 허용: JavaScript도 사용 가능
- ES 모듈 간소화: import 사용 시 문제 해결
- React JSX 설정: 최신 JSX 변환 방식 사용


#### App.tsx 
useState 사용
```
import { useState, useRef, useEffect } from "react";
import "./App.css";
import Editor from "./components/Editor";
import { Todo } from "./types";
import TodoItem from "./components/TodoItem";

function App() {
  const [todos, setTodos] = useState<Todo[]>([]);

  const idRef = useRef(0);

  const onClickAdd = (text: string) => {
    setTodos([
      ...todos,
      {
        id: idRef.current++,
        content: text,
      },
    ]);
  };

  const onClickDelete = (id: number) => {
    setTodos(todos.filter((todo) => todo.id !== id));
  };

  useEffect(() => {
    console.log(todos);
  }, [todos]);

  return (
    <div className="App">
      <h1>Todo</h1>
      <Editor onClickAdd={onClickAdd}></Editor>
      <div>
        {todos.map((todo) => (
          <TodoItem key={todo.id} {...todo} onClickDelete={onClickDelete} />
        ))}
      </div>
    </div>
  );
}

export default App;
```

#### App.tsx
useReducer 로 변경
```
import { useState, useRef, useEffect, useReducer } from "react";
import "./App.css";
import Editor from "./components/Editor";
import { Todo } from "./types";
import TodoItem from "./components/TodoItem";

type Action =
  | {
      type: "CREATE";
      data: {
        id: number;
        content: string;
      };
    }
  | {
      type: "DELETE";
      id: number;
    };

function reducer(state: Todo[], action: Action) {
  switch (action.type) {
    case "CREATE": {
      return [...state, action.data];
    }
    case "DELETE": {
      return state.filter((it) => it.id != action.id);
    }
  }
}

function App() {
  //const [todos, setTodos] = useState<Todo[]>([]);
  const [todos, dispatch] = useReducer(reducer, []);

  const idRef = useRef(0);

  const onClickAdd = (text: string) => {
    dispatch({
      type: "CREATE",
      data: {
        id: idRef.current++,
        content: text,
      },
    });
  };

  const onClickDelete = (id: number) => {
    dispatch({
      type: "DELETE",
      id: id,
    });
  };

  useEffect(() => {
    console.log(todos);
  }, [todos]);

  return (
    <div className="App">
      <h1>Todo</h1>
      <Editor onClickAdd={onClickAdd}></Editor>
      <div>
        {todos.map((todo) => (
          <TodoItem key={todo.id} {...todo} onClickDelete={onClickDelete} />
        ))}
      </div>
    </div>
  );
}

export default App;

```

#### Types.ts
별도의 타입스크립트 파일을 만들어서 타입들을 분리하는게 좋다.
```
export interface Todo {
  id: number;
  content: string;
}
```

### TodoItem.tsx
```
import { Todo } from "../types";

interface Props extends Todo {
  onClickDelete: (id: number) => void;
}

export default function TodoItem(props: Props) {
  const onClickButton = () => {
    props.onClickDelete(props.id);
  };

  return (
    <div>
      {props.id}번 : {props.content}
      <button onClick={onClickButton}>삭제</button>
    </div>
  );
}
```

### Editor.tsx
```
import { useState } from "react";

interface Props {
  onClickAdd: (text: string) => void;
}

export default function Editor(props: Props) {
  const [text, setText] = useState("");

  const onChangeInput = (e: React.ChangeEvent<HTMLInputElement>) => {
    setText(e.target.value);
  };

  const onClickButton = () => {
    props.onClickAdd(text);
    setText("");
  };

  return (
    <div>
      <input value={text} onChange={onChangeInput} />
      <button onClick={onClickButton}>추가</button>
    </div>
  );
}
```

