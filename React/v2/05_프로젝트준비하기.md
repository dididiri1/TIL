# 섹션 5. 프로젝트 준비하기

## Supabase 설정하기

### 1. Supabase 프로젝트 생성
- https://supabase.com 접속 후 로그인
- 새 프로젝트 생성

![](https://github.com/dididiri1/TIL/blob/main/React/v2/images/05_01.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/v2/images/05_02.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/v2/images/05_03.png?raw=true)

### 2. 환경 변수 설정
src/.evn 파일 생성 
```
VITE_SUPABASE_URL=https://xxxxzhmbderniqcamlc.supabase.co
VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY=sb_publixxxxle_xxxxgaPRG2OSZbRNrA_xxxxx
```

### 3. Supabase Client 설정
- src/lib/supabase.ts 파일 생성
```
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseKey = import.meta.env.VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY;

const supabase = createClient(supabaseUrl, supabaseKey);

export default supabase
```

### 4. Supabase 라이브러리 설치
```
npm i
npm i @supabase/supabase-js
```

### 테이블 생성
#### 1. Row Level Security (RLS) 비활성화
- RLS는 특정 권한을 가진 사용자만 데이터를 읽거나 수정할 수 있도록 제한하는 보안 기능
- 학습 단계에서는 복잡도를 줄이기 위해 비활성화
![](https://github.com/dididiri1/TIL/blob/main/React/v2/images/05_04.png?raw=true)

2. 컬럼 생성
- post 테이블 생성
- 필요한 컬럼 추가
![](https://github.com/dididiri1/TIL/blob/main/React/v2/images/05_05.png?raw=true)

### Supabase CLI 사용하기
#### 1. Supabase CLI 설치
```
npm i supabase@">=1.8.1" --save-dev
```

#### 2. Supabase 로그인
```
npx supabase login
```

#### 3. Supabase 초기화
```
npx supabase initd
```

### 타입 자동 생성
#### 1. package.json 스크립트 추가
```
"type-gen": "npx supabase gen types typescript --project-id \"gzbddzhmbderniqcamlc\" --schema public > src/database.types.ts"
```

#### 2. 타입 생성 실행
```
onebite-log % npm run type-gen

> onebite-log@0.0.0 type-gen
> npx supabase gen types typescript --project-id "gzbddzhmbderniqcamlc" --schema public > src/database.types.ts

```
- database.types.ts 생성됨

### Supabase Client에 타입 적용
#### src/lib/supabase.ts
```
import { createClient } from "@supabase/supabase-js";
import { type Database } from "@/database.types";

const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseKey = import.meta.env.VITE_SUPABASE_PUBLISHABLE_DEFAULT_KEY;

const supabase = createClient<Database>(supabaseUrl, supabaseKey);

export default supabase;
```

### 타입 정제하기
#### 공통 타입 정의
- src/types.ts
```
import { type Database } from "./database.types";

export type PostEnitiy = Database["public"]["Tables"]["post"]["Row"];
```
- Supabase에서 자동 생성된 타입을 그대로 사용하지 않고 도메인 단위 타입으로 분리해 관리

![](https://github.com/dididiri1/TIL/blob/main/React/v2/images/05_06.png?raw=true)

### ✨ 정리 포인트
- Supabase + Vite 환경 변수 설정 방법
- Supabase CLI를 활용한 DB 타입 자동 생성
- 프론트엔드에서 타입 안정성 확보 흐름 이해