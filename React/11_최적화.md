# ì„¹ì…˜ 11 ìµœì í™”

## 10.1) ìµœì í™”ë€

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_01.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_02.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_03.png?raw=true)


## 10.2) useMemoì™€ ì—°ì‚° ìµœì í™”

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_04.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_05.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_06.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_07.png?raw=true)

### 
``` 
  const filteredTodos = getFiltereData(); // (2)

  const getAnalyzedDate = () => {
    console.log("getAnalyzedData í˜¸ì¶œ!");
  
    const totalCount = todos.length;
    const doneCount = todos.filter((todo) => todo.isDone).length; // 1()
    const notDoneCount = totalCount - doneCount;

    return {
      totalCount,
      doneCount,
      notDoneCount,
    };
  };

  const { totalCount, doneCount, notDoneCount } = getAnalyzedDate();

``` 
> ğŸ’¡ (1) ì—°ì‚° ê³¼ì •ì€ Filterë¼ëŠ” ë°°ì—´ ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— Todos stateì— ë³´ê´€ëœ ë°ì´í„°ì˜ ê°¯ìˆ˜ê°€  
> ì¦ê°€í• ìˆ˜ë¡ í›¨ì”¬ ë” ì˜¤ë˜ ê±¸ë¦¬ëŠ” í•¨ìˆ˜ê°€ ë  ê²ƒì´ë‹¤. ì™œëƒë©´ Filter ë©”ì†Œë“œëŠ” ë°°ì—´ ë‚´ì— ì „ì²´ ìš”ì†Œë“¤ì„  
> í•œ ë²ˆì”© ë‹¤ ìˆœíšŒí•˜ê¸° ë–„ë¬¸ì´ë‹¤. ê·¸ë˜ì„œ í•¨ìˆ˜ê°€ ë¶ˆí•„ìš”í•˜ê²Œ í˜¸ì¶œë˜ëŠ” ê²½ìš°ë¥¼ ë°©ì§€ í•  ìˆ˜ ìˆì–´ì•¼ ëœë‹¤.  
> (2)ë¥¼ ë³´ë©´ ì´í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ë°”ë¡œ í˜¸ì¶œë˜ê³  ìˆë‹¤. ê²°êµ­ì—ëŠ” ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë   
> ë•Œë§ˆë‹¤ ê³„ì† ìƒˆë¡­ê²Œ í˜¸ì¶œë˜ê³  ìˆë‹¤.

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_08.png?raw=true)

### ë©”ëª¨ì œì´ 
``` 
import "./List.css";
import TodoItem from "./TodoItem";
import { useState, useMemo } from "react";

const List = ({ todos, onUpdate, onDelete }) => {
  const [search, setSearch] = useState("");

  const onChangeSearch = (e) => {
    setSearch(e.target.value);
  };

  const getFiltereData = () => {
    if (search === "") {
      return todos;
    }

    return todos.filter((todo) =>
      todo.content.toLowerCase().includes(search.toLocaleLowerCase())
    );
  };

  const filteredTodos = getFiltereData();

  const { totalCount, doneCount, notDoneCount } = useMemo(() => {
    console.log("getAnalyzedData í˜¸ì¶œ!");

    const totalCount = todos.length;
    const doneCount = todos.filter((todo) => todo.isDone).length;
    const notDoneCount = totalCount - doneCount;

    return {
      totalCount,
      doneCount,
      notDoneCount,
    };
  }, [todos]);
  // ì˜ì¡´ì„± ë°°ì—´ : deps

  return (
    <div className="List">
      <h4>Todo List</h4>
      <div>
        <div>total: {totalCount}</div>
        <div>done: {doneCount}</div>
        <div>notDone: {notDoneCount}</div>
      </div>
      <input
        value={search}
        onChange={onChangeSearch}
        placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”."
      />
      <div className="todos_wrapper">
        {filteredTodos.map((todo) => {
          return (
            <TodoItem
              key={todo.id}
              {...todo}
              onUpdate={onUpdate}
              onDelete={onDelete}
            />
          );
        })}
      </div>
    </div>
  );
};

export default List;

``` 
 
## 10.3) React.memoì™€ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ìµœì í™”

### 1) memo ë¦¬ì—‘íŠ¸ì˜ ë‚´ì¥ ë©”ì†Œë“œ
- ì¸ìˆ˜ë¡œ ë¦¬ì—‘íŠ¸ì˜ ì»´í¼ë„ŒíŠ¸ë¥¼ ë°›ì•„ì„œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì— ìµœì í™” ê¸°ëŠ¥ì„ ì¶”ê°€í•œ ë‹¤ìŒì— ê²°ê³¼ ê°’ìœ¼ë¡œ ë°˜í™˜
- propsë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë©”ëª¨ì´ì œì´ì…˜ ëœë‹¤. 
- ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë˜ë”ë¼ë„ ìì‹ ì´ ë°›ëŠ” propsê°€ ë°”ë€Œì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œëŠ” ë¦¬ë Œë”ë§ì´ ë°œìƒë˜ì§€ ì•ŠëŠ”ë‹¤.
- ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€ ìµœì í™”ë¨

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_09.png?raw=true)

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_10.png?raw=true)

### 2) memo ìµœì í™” ì „
- í™”ë©´ì— ë°œìƒí•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë¼ë Œë”ë§ ë˜ê³  ìˆë‹¤. 
- í—¤ë” ì»´í¬ë„ŒíŠ¸ëŠ” ë¦¬ë Œë”ë§ì´ ë°œìƒí•  ì´ìœ ê°€ ì—†ìŒ

![](https://github.com/dididiri1/TIL/blob/main/React/images/11_11.png?raw=true)

### 3) memo ìµœì í™” í›„
- ë©”ëª¨ë¥¼ ì´ìš©í•˜ë©´ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. 
- ë‹¨, ìì‹ ì´ ë°›ëŠ” propsê°€ ë°”ë€Œì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œëŠ” ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ì§€ ì•ŠìŒ
#### Header.jsx
``` 
import "./Header.css";
import { memo } from "react";

const Header = () => {
  return (
    <div className="Header">
      <h3>ì˜¤ëŠ˜ì€ ğŸ“–</h3>
      <h1>{new Date().toDateString()}</h1>
    </div>
  );
};

const memoizedHeader = memo(Header);

export default memoizedHeader;

```
``` 
"react-refresh/only-export-components": "off",
``` 

#### TodoItem.jsx

``` 
import "./TodoItem.css";
import { memo } from "react";

const TodoItem = ({ id, isDone, content, date, onUpdate, onDelete }) => {
  const onChageCheckBox = () => {
    onUpdate(id);
  };

  const onClickDeleteButton = () => {
    onDelete(id);
  };

  return (
    <div className="TodoItem">
      <input onChange={onChageCheckBox} checked={isDone} type="checkbox" />
      <div className="content">{content}</div>
      <div className="date">{new Date(date).toLocaleDateString()}</div>
      <button onClick={onClickDeleteButton}>ì‚­ì œ</button>
    </div>
  );
};

export default memo(TodoItem);

```

> ğŸ’¡ TodoItemì€ ì»´í¬ë„ŒíŠ¸ê°€ propsë¡œ ë°›ëŠ” ì´ onUpdateì™€ onDelete ìƒˆë¡œìš´ í•¨ìˆ˜ë¡œì„œ  
> ì „ë‹¬ì´ ë˜ê³  ìˆê¸° ë•Œë¬¸ì— ê·¸ë˜ì„œ ê²°êµ­ì€ ë©”ëª¨ë¥¼ ì ìš©í–ˆë‹¤ê³  í•˜ë”ë¼ë„ ë¦¬ë Œë”ë§ì´ ë°œìƒí•˜ê²Œ ëœë‹¤.  
> ê·¸ë ‡ê¸° ë–„ë¬¸ì— ì´ë ‡ê²Œ ê°ì²´ íƒ€ì…ì˜ ê°’ì„ propsë¡œ ë°›ê³  ìˆëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ë©”ëª¨ ë©”ì„œë“œë¥¼ ì ìš©í•˜ê¸°ë§Œ í•œë‹¤ê³   
> í•´ì„œ ìµœì í™”ê°€ ì´ë£¨ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ ë‘ ê°€ì§€ ë°©ë²•ì„ ì ìš©í•  ìˆ˜ ìˆëŠ”ë° ì²« ë²ˆì¨° ë°©ë²•ì€ ì•±ì»´í¬ë„Œì—ì„œ   
> ì´ í•¨ìˆ˜ë¥¼ ìì œë¥¼ ë©”ëª¨ì´ì œì´ì…˜í•´ì„œ ë¦¬ë Œë”ë§ ë˜ë”ë¼ë„ ë‹¤ì‹œ ìƒì„±ë˜ì§€ ì•Šê²Œ ë°©ì§€í•˜ëŠ” ë°©ë²•ê³¼ ë‘ ë²ˆì§¸ ë°©ë²•ì€  
> toDoItem ì»´í¬ë„ŒíŠ¸ì˜ ë©”ëª¨ í•¨ìˆ˜ì•ˆì— ë‘ ë²ˆì§¸ ì¸ìˆ˜ë¡œ ì½œë°± í•¨ìˆ˜ë¥¼ ì¶”ê°€ë¡œ ì „ë‹¬í•´ì„œ ìµœì í™” ê¸°ëŠ¥ì„  
> ì»¤ìŠ¤í„°ë§ˆì´ì§• í•´ì£¼ëŠ” ë°©ë²•ì´ ìˆë‹¤.

### 4) ë‘ ë²ˆì¨° ë°©ë²• - ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ (HOC)

```
export default memo(TodoItem, (prevProps, nextProps) => {
  // ë°˜í™˜ê°’ì— ë”°ë¼, Propsê°€ ë°”ë€Œì—ˆëŠ”ì§€ ì•ˆë°”ë€Œì—ˆëŠ”ì§€ íŒë‹¨
  // T -> Props ë°”ë€Œì§€ ì•ŠìŒ -> ë¦¬ë Œë”ë§ X
  // F -> Props ë°”ë€œ -> ë¦¬ë Œë”ë§ O
  // onUpdate, onDeleteë§Œ ëº´ê³  id, isDone, content, data ê°’ë§Œ
  // ë°”ë€Œì—ˆì„ ë–„ë§Œ ë¦¬ë Œë”ë§ ì‹œì¼œì£¼ë©´ ë˜ë‹ˆê¹ ì½œë°± í•¨ìˆ˜ ì•ˆì— ì¡°ê±´ë¬¸ ì •ì˜

  if (prevProps.id !== nextProps.id) {
    return false;
  }
  if (prevProps.isDone !== nextProps.isDone) {
    return false;
  }
  if (prevProps.content !== nextProps.content) {
    return false;
  }
  if (prevProps.date !== nextProps.date) {
    return false;
  }
});

```

ê³ ì°¨ ì»´í¬ë„ŒíŠ¸(HOC) ê´€ë ¨ ì•„í‹°í´

https://patterns-dev-kr.github.io/design-patterns/hoc-pattern/

## 10.4) useCallbackê³¼ í•¨ìˆ˜ ì¬ìƒì„± ë°©ì§€


```

```

> ğŸ’¡ 10.3 ì²˜ëŸ¼ props ì¼ì¼ì´ ë‹¤ ë¹„êµí•˜ë„ë¡ ì½”ë“œë¥¼ ì¨ì•¼ ëœë‹¤ë©´ ìƒë‹¹íˆ ë¶ˆí¸í•˜ê³  ê·€ì°®ë‹¤.  
> ê²Œë‹¤ê°€ ë˜ props ì´ë¦„ ë°”ë€Œê¸°ë¼ë„ í•˜ë©´ ì´ ì½œë°± í•¨ìˆ˜ ì•ˆì—ë„ ë‹¤ ë°”ê¿”ì¤˜ì•¼ ë˜ê¸°ë„ í•˜ê³   
> ìƒˆë¡œìš´ props ì¶”ê°€ë˜ë©´ ì¡°ê±´ì„ ì¶”ê°€í•´ì¤˜ì•¼ ë˜ëŠ” ë²ˆê±°ë¡­ë‹¤. ê·¸ë˜ì„œ ì´ëŸ´ ë•Œì—ëŠ” ê·¸ëƒ¥ ì´  
> onUpdateì™€ onDeleteë¼ëŠ” í•¨ìˆ˜ê°€ ì• ì´ˆì— ë‹¤ì‹œ ìƒì„±ë˜ì§€ ì•Šë„ë¡ ìµœì í™”í•˜ëŠ” ê²Œ  
> ì¡°ê¸ˆ ë” ì¢‹ì€ ë°©ë²•ì´ ë  ìˆ˜ ìˆë‹¤.

### useCollback
- importë¬¸ì— useCollback ì¶”ê°€ì ì¸ ë¦¬ì—‘íŠ¸ í›…ì„ ì„¤ì • 
```
import { useState, useRef, useReducer, useCallback } from "react";
```

- ë Œë”ë§ ë  ë•Œ ë§ˆìš´íŠ¸ ë  ë•Œì—ë§Œ ì´ í•¨ìˆ˜ë¥¼ ë”± í•œë²ˆ ìƒìƒí˜¸ê³  ê·¸ ë’¤ì—ëŠ” ìƒì„±ì´ ì•ˆëœë‹¤. 
```
const onCreate = useCallback((content) => {
    dispatch({
      type: "CREATE",
      data: {
        id: idRef.current++,
        isDone: false,
        content: content,
        date: new Date().getTime(),
      },
    });
  }, []);

  const onUpdate = useCallback((targetId) => {
    dispatch({
      type: "UPDATE",
      targetId: targetId,
    });
  }, []);

  const onDelete = useCallback((targetId) => {
    dispatch({
      type: "DELETE",
      targetId: targetId,
    });
  }, []);
```

### 1) ìµœì í™” ê¸°ì¤€
> ğŸ’¡ ìµœì í™”ë¥¼ ì–¸ì œ í•˜ë©´ ì¢‹ì„ì§€ì— ë§í•˜ë©´ ë³´í†µ ìš°ë¦¬ê°€ ë¦¬ì•¡íŠ¸ ì•±ì„ ìµœì í™œ ë•ŒëŠ” í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ë¥¼  
> ê±°ì˜ ì™„ì„±í•œ ìƒíƒœì—ì„œ ìµœì í™”ë¥¼ í•˜ê²Œ ëœë‹¤. ê·¸ë˜ì„œ í•­ìƒ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ê²Œ ë¨¼ì €ì•¼ ë¼ì•¼ ë˜ê³   
> ê·¸ë¦¬ê³  ê¸°ëŠ¥ì´ ì™„ì„±ì´ ë˜ë©´ ê·¸ ë’¤ì— ìµœì í™”ë¥¼ í•˜ëŠ” ê²Œ ì¼ë°˜ì ì¸ ë°©ë²•ì´ë‹¤. ì™œëƒí•˜ë©´ ìµœì í™”ë¥¼  
> ìœ„í•´ì„œ ì´ëŸ° useCallback ê°™ì€ ë©”ì„œë“œë“¤ì„ ì ìš©í•´ ë†“ê³  ë‚˜ë©´ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ë§ë¶™ì´ê±°ë‚˜  
> ê¸°ëŠ¥ì„ ìˆ˜ì •í•´ì•¼ ë  ë–„ ì´ ìµœì í™”ê°€ í’€ë¦¬ê²Œ ë˜ê±°ë‚˜ ì•„ë‹ˆë©´ ì•„ì˜ˆ ê³ ì¥ë‚˜ê²Œ ë˜ì–´ ë²„ë¦¬ëŠ” ê²½ìš°ë„ ìƒê¸´ë‹¤.  
> ê·¸ë˜ì„œ ë˜ë„ë¡ì´ë©´ ê¸°ëŠ¥ êµ¬í˜„ì„ ë¨¼ì € ì™„ë£Œ í•˜ê³  ë§ˆì§€ë§‰ì— ìµœì í™”ë¥¼ í•˜ëŠ”ê²Œ ê¶Œì¥ 

### 2) ìµœì í™”ì˜ ëŒ€ìƒ
> ğŸ’¡ ëª¨ë“  ê²ƒë“¤ì— ìµœì í™”ë¥¼ ì ìš©í•˜ëŠ”ê²ƒ ë³´ë‹¤ëŠ” ê¼­ ìµœì í™”ê°€ í•„ìš”í•  ê²ƒ ê°™ì€ ì—°ì‚°ë“¤ì´ë‚˜ í•¨ìˆ˜ë“¤ì´ë‚˜  
> ì»´í¬ë„ŒíŠ¸ì—ë§Œ ìµœì í™”ë¥¼ ì ìš©í•˜ëŠ”ê²Œ ì¢‹ë‹¤.

ì•„í‹°í´ "When to use useMemo, useCallback"

https://goongoguma.github.io/2021/04/26/When-to-useMemo-and-useCallback/